# 端口

各种存储器都和CPU的地址线、数据线、控制线相连。CPU在操纵他们的时候，都当做内存，把它们总地看做一个由若干存储单元组成的逻辑存储器，这个逻辑存储器我们称其为**内存地址空间**。

在PC机中，和CPU通过总线相连的芯片除各种**存储器**外，还有以下3种芯片：

1. 各种**接口卡**(比如:网卡、显卡)上的接口芯片,它们控制接口卡进行工作
2. 主板上的**接口芯片**,CPU通过它们对部分外设进行访问
3. **其他芯片**,用来存储相关的系统信息,或进行相关的输入输出处理

这些芯片都有一组可以由CPU进行读写的寄存器,这些寄存器的相同点有:

1. 都和CPU的总线相连(通过它们所在的芯片相连)
2. CPU对它们进行读或写的时候都通过控制线向他们所在的芯片发出端口读写命令

从CPU的角度,将这些寄存器都当做端口,对其统一编址,从而建立了一个统一的端口地址空间,每个端口在地址空间中都有一个地址.

CPU可以直接读写三个地方的数据:

1. CPU内部的寄存器
2. 内存单元
3. 端口

## 端口的读写

访问端口时,**cpu通过端口地址来定位端口**.

因端口所在的芯片和CPU通过总线相连,所以,**端口地址和内存地址一样,通过地址总线来传送**.

在PC系统中,**CPU最多定位64KB个不同的端口**,则端口的范围为0~65535.

对端口的读写**不能**用`mov`、`push`、`pop`等内存读写指令.

端口的读写指令分别为:`in`,`out`.

| 访问指令 | |
|:---|:---|
|内存访问指令|`mov ax,ds:[8]`<br>1.CPU通过**地址线**将地址信息8发出<br>2.CPU通过**控制线**发出**内存读命令**,选中**存储器芯片**,并通知它,将要从中读取数据<br>3.**存储器**将8号单元中的数据通过数据线送入CPU|
|端口访问指令|`in al,60h`<br>1.CPU通过**地址线**将地址信息60h发出<br>2.CPU通过**控制线**发出**端口读命令**,选中**端口所在的芯片**,并通知它,将要从中读取数据<br>3.**端口所在的芯片**将60h端口中的数据通过数据线送入CPU|

```asm
;对0~255以内的端口进行读写
in al,20h   ;从20h端口读入一个字节
out 20h,al  ;往20h端口写入一个字节
;对256~65535的端口进行读写时,端口号放在dx中
mov dx,3f8h ;将端口号3f8h放入dx
in al,dx    ;从3f8h端口读一个字节
out dx,al   ;往3f8h端口写一个字节
```

## CMOS RAM芯片

## shl和shr指令

## CMOS RAM中存放的时间信息
